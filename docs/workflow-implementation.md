# 工作流程实现说明

## 功能概述

根据您提供的设计图，我们完全重新实现了音频编辑器的工作流程，实现了从文本输入到分句编辑的完整流程。

## 工作流程步骤

### 第一步：文本输入
- **界面**：大文本输入框，绿色提示文字"输入文本区域"
- **功能**：用户输入要处理的文本内容
- **操作**：输入完成后点击"开始分句"按钮

### 第二步：选择分句方式
- **界面**：弹出对话框，提供三种分句选项
- **选项**：
  - **按标点**：根据标点符号分句
  - **按段落**：根据段落结构分句
  - **AI自动**：智能自动分句
- **操作**：选择分句方式后点击"确认"

### 第三步：时间轴展示和编辑
- **界面**：切换到分句时间轴视图
- **功能**：
  - 顶部显示句子时间轴，每个句子有对应的指示器
  - 底部是句子语音编辑区域
  - 点击句子可以进行编辑

## 技术实现

### 1. 前端分句模拟
由于后端分句功能尚未实现，我们使用前端分句工具进行模拟：

```typescript
// 使用TextSegmentation工具进行分句
const segments = TextSegmentation.segment(text, {
  method: method,
  minLength: 5,
  maxLength: 100,
  preserveWhitespace: true
})
```

### 2. 模拟语音数据
为每个分句生成模拟的语音数据：

```typescript
const mockSegments = segments.map((segment, index) => ({
  ...segment,
  startTime: index * 3, // 假设每个句子3秒
  endTime: (index + 1) * 3,
  duration: 3,
  isPlaying: false,
  audioUrl: `mock_audio_${index}.mp3`, // 模拟音频URL
  voice: 'zhichu',
  speed: 1.0,
  pitch: 1.0
}))
```

### 3. 工作流程状态管理
使用`workflowStage`状态管理不同的工作阶段：

- `'input'`：文本输入阶段
- `'timeline'`：分句时间轴阶段
- `'tracks'`：传统轨道视图阶段

## 组件结构

### 1. TextInputArea.vue
- 文本输入界面组件
- 绿色主题，匹配设计图
- 大文本输入框和"开始分句"按钮

### 2. SegmentationDialog.vue
- 分句方式选择对话框
- 深色主题，单选按钮样式
- 三种分句方式选择

### 3. TimelineSegments.vue
- 分句时间轴展示组件
- 句子指示器和编辑区域
- 完全匹配设计图的布局

## 界面特点

### 1. 深色主题
- 黑色背景 (#1a1a1a)
- 白色文字和边框
- 绿色强调色 (#00ff00)

### 2. 简洁设计
- 大文本输入框，操作简单
- 清晰的分句选择界面
- 直观的时间轴展示

### 3. 响应式布局
- 支持不同屏幕尺寸
- 移动端适配
- 流畅的动画效果

## 使用流程

1. **启动应用**：默认进入文本输入阶段
2. **输入文本**：在文本框中输入要处理的文本
3. **开始分句**：点击"开始分句"按钮
4. **选择方式**：在弹出的对话框中选择分句方式
5. **查看结果**：自动切换到分句时间轴视图
6. **编辑句子**：点击任意句子进行语音编辑

## 未来扩展

### 1. 后端集成
当后端分句功能实现后，可以轻松替换前端模拟：

```typescript
// 替换为真实的后端调用
const response = await ttsApi.segment({
  text: text,
  method: method
})
```

### 2. 语音生成
集成真实的TTS服务：

```typescript
// 为每个分句生成真实语音
const audioResponse = await ttsApi.synthesize({
  text: segment.text,
  voice: segment.voice,
  speed: segment.speed,
  pitch: segment.pitch
})
```

### 3. 高级编辑功能
- 拖拽调整句子位置
- 批量编辑功能
- 语音效果处理
- 导出功能

## 注意事项

1. **前端模拟**：当前使用前端分句工具模拟，不调用后端接口
2. **模拟数据**：语音数据为模拟数据，实际使用时需要真实音频
3. **性能考虑**：大量文本分句可能影响性能，建议分批处理
4. **兼容性**：确保浏览器支持现代JavaScript特性

这个实现完全符合您的设计图要求，提供了直观的工作流程和专业的音频编辑体验。
