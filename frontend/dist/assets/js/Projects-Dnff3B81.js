import{d as oe,n as j,P as ne,c as m,o as p,a as e,w as o,E as le,b as s,e as se,r as c,f as ae,g as d,i as re,u as b,F as ie,t as de,y as ce,k as ue,Q as me,R as pe,D as _e,G as g,J as fe,K as _,l as ve,S as ye,C as x,T as ke,U as ge,V as we}from"./index-BgjiYeva.js";import{u as je}from"./el-overlay-BmpTTlvR.js";/* empty css                     *//* empty css                  *//* empty css                */import{_ as Ce}from"./_plugin-vue_export-helper-T9wiJ-W-.js";const Ee={class:"projects"},Pe={class:"header-content"},be={class:"title"},xe={class:"header-actions"},Ve={class:"projects-content"},he={key:0,class:"projects-grid"},De=["onClick"],Fe={class:"project-header"},Re={class:"project-info"},Be={key:0},Ue={key:1,class:"no-description"},Me={class:"project-meta"},Ie={class:"meta-item"},Se={class:"meta-item"},$e={class:"project-actions"},Le={key:1,class:"empty-projects"},Ne=oe({__name:"Projects",setup(Oe){const V=ve(),f=je(),v=j(!1),y=j(!1),w=j(null),C=j(),a=ne({name:"",description:""}),S={name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:1,max:50,message:"项目名称长度在 1 到 50 个字符",trigger:"blur"}]},{projects:$,hasProjects:L,isSaving:N}=f,h=()=>{y.value=!1,w.value=null,a.name="",a.description="",v.value=!0},D=r=>{y.value=!0,w.value=r,a.name=r.name,a.description=r.description,v.value=!0},O=async()=>{C.value&&await C.value.validate(async r=>{if(r)try{if(y.value&&w.value){const t={...w.value,name:a.name,description:a.description};await f.saveProject(t),_.success("项目更新成功")}else await f.createProject(a.name,a.description),_.success("项目创建成功");v.value=!1}catch(t){console.error("保存项目失败:",t),_.error("保存项目失败")}})},F=r=>{f.loadProject(r.id),V.push("/editor")},T=async r=>{const{action:t,project:u}=r;switch(t){case"edit":D(u);break;case"export":try{const l=await f.exportProject(u.id),E=new Blob([JSON.stringify(l)],{type:"application/json"}),i=URL.createObjectURL(E),k=document.createElement("a");k.href=i,k.download=`${u.name}.json`,k.click(),URL.revokeObjectURL(i),_.success("项目导出成功")}catch(l){console.error("导出项目失败:",l),_.error("导出项目失败")}break;case"delete":try{await we.confirm(`确定要删除项目 "${u.name}" 吗？此操作不可恢复。`,"确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),f.deleteProject(u.id),_.success("项目删除成功")}catch(l){l!=="cancel"&&(console.error("删除项目失败:",l),_.error("删除项目失败"))}break}},H=r=>new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(new Date(r)),z=()=>{V.push("/")};return(r,t)=>{const u=c("FolderOpened"),l=se,E=c("Plus"),i=ae,k=c("HomeFilled"),A=le,J=c("MoreFilled"),R=c("Edit"),P=ge,q=c("Download"),G=c("Delete"),K=ke,Q=ye,B=c("VideoPlay"),W=c("Clock"),X=ce,Y=re,Z=ue,U=_e,M=pe,ee=me,te=fe;return p(),m("div",Ee,[e(Z,{class:"projects-container"},{default:o(()=>[e(A,{class:"projects-header"},{default:o(()=>[s("div",Pe,[s("div",be,[e(l,null,{default:o(()=>[e(u)]),_:1}),t[5]||(t[5]=s("h1",null,"项目管理",-1))]),s("div",xe,[e(i,{type:"primary",onClick:h},{default:o(()=>[e(l,null,{default:o(()=>[e(E)]),_:1}),t[6]||(t[6]=d(" 新建项目 ",-1))]),_:1}),e(i,{onClick:z},{default:o(()=>[e(l,null,{default:o(()=>[e(k)]),_:1}),t[7]||(t[7]=d(" 返回首页 ",-1))]),_:1})])])]),_:1}),e(Y,{class:"projects-main"},{default:o(()=>[s("div",Ve,[b(L)?(p(),m("div",he,[(p(!0),m(ie,null,de(b($),n=>(p(),m("div",{key:n.id,class:"project-card",onClick:I=>F(n)},[s("div",Fe,[s("h3",null,g(n.name),1),e(Q,{onCommand:T},{dropdown:o(()=>[e(K,null,{default:o(()=>[e(P,{command:{action:"edit",project:n}},{default:o(()=>[e(l,null,{default:o(()=>[e(R)]),_:1}),t[8]||(t[8]=d(" 编辑 ",-1))]),_:1},8,["command"]),e(P,{command:{action:"export",project:n}},{default:o(()=>[e(l,null,{default:o(()=>[e(q)]),_:1}),t[9]||(t[9]=d(" 导出 ",-1))]),_:1},8,["command"]),e(P,{command:{action:"delete",project:n},divided:""},{default:o(()=>[e(l,null,{default:o(()=>[e(G)]),_:1}),t[10]||(t[10]=d(" 删除 ",-1))]),_:1},8,["command"])]),_:2},1024)]),default:o(()=>[e(i,{type:"text",onClick:t[0]||(t[0]=x(()=>{},["stop"]))},{default:o(()=>[e(l,null,{default:o(()=>[e(J)]),_:1})]),_:1})]),_:2},1024)]),s("div",Re,[n.description?(p(),m("p",Be,g(n.description),1)):(p(),m("p",Ue,"暂无描述"))]),s("div",Me,[s("div",Ie,[e(l,null,{default:o(()=>[e(B)]),_:1}),s("span",null,g(n.tracks.length)+" 个轨道",1)]),s("div",Se,[e(l,null,{default:o(()=>[e(W)]),_:1}),s("span",null,g(H(n.updatedAt)),1)])]),s("div",$e,[e(i,{type:"primary",size:"small",onClick:x(I=>F(n),["stop"])},{default:o(()=>[e(l,null,{default:o(()=>[e(B)]),_:1}),t[11]||(t[11]=d(" 打开 ",-1))]),_:1},8,["onClick"]),e(i,{size:"small",onClick:x(I=>D(n),["stop"])},{default:o(()=>[e(l,null,{default:o(()=>[e(R)]),_:1}),t[12]||(t[12]=d(" 编辑 ",-1))]),_:1},8,["onClick"])])],8,De))),128))])):(p(),m("div",Le,[e(X,{description:"暂无项目"},{default:o(()=>[e(i,{type:"primary",onClick:h},{default:o(()=>[...t[13]||(t[13]=[d(" 创建第一个项目 ",-1)])]),_:1})]),_:1})]))])]),_:1})]),_:1}),e(te,{modelValue:v.value,"onUpdate:modelValue":t[4]||(t[4]=n=>v.value=n),title:y.value?"编辑项目":"新建项目",width:"500px"},{footer:o(()=>[e(i,{onClick:t[3]||(t[3]=n=>v.value=!1)},{default:o(()=>[...t[14]||(t[14]=[d("取消",-1)])]),_:1}),e(i,{type:"primary",onClick:O,loading:b(N)},{default:o(()=>[d(g(y.value?"更新":"创建"),1)]),_:1},8,["loading"])]),default:o(()=>[e(ee,{model:a,rules:S,ref_key:"projectFormRef",ref:C,"label-width":"80px"},{default:o(()=>[e(M,{label:"项目名称",prop:"name"},{default:o(()=>[e(U,{modelValue:a.name,"onUpdate:modelValue":t[1]||(t[1]=n=>a.name=n),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1}),e(M,{label:"项目描述",prop:"description"},{default:o(()=>[e(U,{modelValue:a.description,"onUpdate:modelValue":t[2]||(t[2]=n=>a.description=n),type:"textarea",rows:3,placeholder:"请输入项目描述（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Ge=Ce(Ne,[["__scopeId","data-v-999af6de"]]);export{Ge as default};
